---
title: 'Chef 13 Upgrade: `knife-cookbook-doc` gem upgrade'
description: 'Fixing odd `Logger` entries in autogenerated `knife-cookbook-doc` `README.md`s for Chef 13'
categories: findings chef-13-upgrade
tags: findings chef-13-upgrade chef knife-cookbook-doc chef-13 documentation
no_toc: true
---
{% include posts/chef-13/intro.html %}

I use the gem [`knife-cookbook-doc`][knife-cookbook-doc] to autogenerate documentation from my Chef cookbooks. It allows me to ensure that documentation is kept right next to source files, which promotes changing of documentation at the same time as code, as well as make it easier to keep updated as it's a task that can be automated.

However, when upgrading to Chef 13, I found that my `README.md`'s `dependencies` section had:

```markdown
* #<Logger:0x0000000004397548> () (Recommended but not required)
* #<Logger:0x0000000004397548> () (Suggested but not required)
* Conflicts with #<Logger:0x0000000004397548> ()
```

Digging into the code, I found this was triggered by the `recommendations`, `suggestions` and `conflicting` methods, which read from the corresponding `recommends`, `suggests` and `conflicts` fields within the cookbook's metadata. As those fields no longer existed, a `Logger` was returned, instead of the valid metadata.

I [raised a PR][knife-cookbook-doc-0-25] which was merged within a few hours and released as [`v0.25.0`][knife-cookbook-doc-0-25], and can be installed with:

```sh
chef gem install knife-cookbook-doc -v 0.25.0
```

[knife-cookbook-doc]: https://github.com/realityforge/knife-cookbook-doc
[knife-cookbook-doc-0-25]: https://rubygems.org/gems/knife-cookbook-doc/versions/0.25.0
[knife-cookbook-doc-pr]: https://github.com/realityforge/knife-cookbook-doc/pull/41
[chef-remove-metadata]: https://docs.chef.io/release_notes.html#deprecated-cookbook-metadata-has-been-removed
