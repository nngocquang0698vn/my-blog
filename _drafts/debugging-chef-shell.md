---
title: Using `chef-shell` to debug attributes and recipes
description:
categories:
tags:
---
- If you're ever using the `node` attributes that are generated by [Ohai] i.e. `node['ec2']`, you'll soemtimes want to be able to test what these attributes are before running against it,
- or determining what the final state of attributes look like once ready to converge Chef

This can be done using the `chef-shell` command, which provides an interactive Ruby REPL, much like how [pry][] works. However, within this REPL, you also gain access to other Chef variables, for instance:

```
chef (13.6.4)> node['uptime']
 => "6 days 23 hours 12 minutes 27 seconds"
chef (13.6.4)> node.run_list
 => #<Chef::RunList:0x00000004c5e0a0 @run_list_items=[#<Chef::RunList::RunListItem:0x00000004b8dfb8 @version=nil, @type=:recipe, @name="cookbook-spectat::default">]>
chef (13.6.4)>
```


## Without a Chef Server

When you're not running against a Chef server, for instance when you're using [Chef Solo], you will either want to run it in standalone mode:

```
$ chef-shell
loading configuration: none (standalone session)
Session type: standalone
Loading....done.

This is the chef-shell.
 Chef Version: 13.6.4
 https://www.chef.io/
 https://docs.chef.io/

run `help' for help, `exit' or ^D to quit.

Ohai2u jamie@TheColonel.localdomain!
chef (13.6.4)>
```

Or in solo mode:

```
TODO
```

Confusingly, this is different to running `chef-client`, which asks for `-z` for a Chef Solo session.

## With a Chef Server

But when running against a Chef server, you need to run it in client mode, with `-z` / `--client`:

```
$ chef-shell -c client.rb -j dna.json
loading configuration: client.rb
Session type: client
Loading...resolving cookbooks for run list: ["cookbook-spectat::default"]
.Synchronizing cookbooks:
  - yum (0.1.x)
  - yum-epel (1.2.3)
  - php-fpm (2.3.4)
done.

This is the chef-shell.
 Chef Version: 13.6.4
 https://www.chef.io/
 https://docs.chef.io/

run `help' for help, `exit' or ^D to quit.

Ohai2u kitchen@2be8ff185c16!
Chef (13.6.4)>
```

Notice that in this case, the shell goes up to the Chef server, requesting what versions of dependencies and what the run list was for the node. This also pulls down all attributes that are available for the node.

## On a Test-Kitchen Node

When running on a node that you're using Test-Kitchen with, you will need to run it at a minimum with `-c client.rb` to prefer the local cookbooks and config. Additionally, to ensure that attribute config is correct, it's worth also adding `-j dna.json`.

```
$ cd /tmp/kitchen
$ chef-shell -c client.rb -j dna.json
loading configuration: client.rb
Session type: standalone
Loading...done.

This is the chef-shell.
 Chef Version: 13.6.4
 https://www.chef.io/
 https://docs.chef.io/

run `help' for help, `exit' or ^D to quit.

Ohai2u kitchen@2be8ff185c16!
Chef (13.6.4)>
```

[debugging-chef-pry]:
